<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.ckeditor.com/ckeditor5/37.0.1/classic/ckeditor.js"></script>
    <!-- <script src="js/editor.js" type="module"></script> -->
    <!-- <script src="https://cdn.ckeditor.com/ckeditor5/37.0.1/classic/translations/ko.js"></script> -->

    
<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<!-- include summernote css/js -->
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
<!--  -->
<script src=" https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.18/lang/summernote-ko-KR.min.js"></script>
    <style>
        table,
        tr,
        td {
            border: 1px solid black;
            border-collapse: collapse;
        }

        input[type=text] {
            width: 900px;
        }

        tr {
            height: 40px;
        }

        tr:nth-child(2) {
            height: 500px;
        }

        td:nth-child(1) {
            padding-right: 90px;
        }

        .ck.ck-editor {
            max-width: 100%;
        }

        .ck-editor__editable {
            min-height: 500px;
        }
    </style>
</head>

<body>
    <p hidden id="hidcont" th:text="${boardVo.cont}"></p>
    <h2>글수정</h2>
    <hr>
    <form action="/Board/Write" method="post"
        enctype="multipart/form-data">
        <table>
            <tr>
                <td><b>제목<b></td>
                <td><input type="text" name="title" th:value="${boardVo.title}"></td>
            </tr>
            <tr id="conttr">
                <td><b>내용<b></td>
                <td id="textar" name="cont"></td>
            </tr>
            <tr>
                <td><b>첨부파일<b></td>
                <td><input type="file" name="" id=""></td>
            </tr>
            <tr>
                <td colspan="2" style="text-align: right;">
                    <input type="submit" value="수정">
                    <button onclick="location='/Board/List'">목록으로</button>
                </td>
            </tr>
        </table>
    </form>
</body>
<script>
	// 툴바생략
	$(document).ready(function() {

let toolbar = [
        // 글꼴 설정
        ['fontname', ['fontname']],
        // 글자 크기 설정
        ['fontsize', ['fontsize']],
        // 굵기, 기울임꼴, 밑줄,취소 선, 서식지우기
        ['style', ['bold', 'italic', 'underline','strikethrough', 'clear']],
        // 글자색
        ['color', ['forecolor','color']],
        // 표만들기
        ['table', ['table']],
        // 글머리 기호, 번호매기기, 문단정렬
        ['para', ['ul', 'ol', 'paragraph']],
        // 줄간격
        ['height', ['height']],
        // 그림첨부, 링크만들기, 동영상첨부
        ['insert',['picture','link','video']],
        // 코드보기, 확대해서보기, 도움말
        ['view', ['codeview','fullscreen', 'help']]
      ];

let setting = {
            height : 600,
            disableResizeEditor: true,
            minHeight : null,
            maxHeight : null,
            focus : true,
            lang : 'ko-KR',
            toolbar : toolbar,
            //콜백 함수
            callbacks : { 
            	onImageUpload : function(files, editor, welEditable) {
            // 파일 업로드(다중업로드를 위해 반복문 사용)
            for (let i = files.length - 1; i >= 0; i--) {
            uploadSummernoteImageFile(files[i],
            this);
            		}
            	}
            }
         };
        $('#textar').summernote(setting);
        $('#textar').summernote('code', $('#hidcont').text());
        });
        
        function uploadSummernoteImageFile(file, el) {
			data = new FormData();
			data.append("file", file);
			$.ajax({
				data : data,
				type : "POST",
				url : "uploadSummernoteImageFile",
				contentType : false,
				enctype : 'multipart/form-data',
				processData : false,
				success : function(data) {
					$(el).summernote('editor.insertImage', data.url);
				}
			});
		}
</script>

</html>